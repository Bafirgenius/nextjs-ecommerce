_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[13],{"20a2":function(e,t,r){e.exports=r("nOHt")},Ivv9:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order/[id]",function(){return r("u6i0")}])},YFqc:function(e,t,r){e.exports=r("cTJO")},cTJO:function(e,t,r){"use strict";var n=r("J4zp"),c=r("284h");t.__esModule=!0,t.default=void 0;var a=c(r("q1tI")),o=r("elyg"),i=r("nOHt"),s=r("vNVm"),l={};function d(e,t,r,n){if(e&&(0,o.isLocalURL)(t)){e.prefetch(t,r,n).catch((function(e){0}));var c=n&&"undefined"!==typeof n.locale?n.locale:e&&e.locale;l[t+"%"+r+(c?"%"+c:"")]=!0}}var u=function(e){var t=!1!==e.prefetch,r=(0,i.useRouter)(),c=r&&r.pathname||"/",u=a.default.useMemo((function(){var t=(0,o.resolveHref)(c,e.href,!0),r=n(t,2),a=r[0],i=r[1];return{href:a,as:e.as?(0,o.resolveHref)(c,e.as):i||a}}),[c,e.href,e.as]),f=u.href,p=u.as,j=e.children,b=e.replace,O=e.shallow,h=e.scroll,m=e.locale;"string"===typeof j&&(j=a.default.createElement("a",null,j));var y=a.Children.only(j),v=y&&"object"===typeof y&&y.ref,x=(0,s.useIntersection)({rootMargin:"200px"}),g=n(x,2),w=g[0],N=g[1],_=a.default.useCallback((function(e){w(e),v&&("function"===typeof v?v(e):"object"===typeof v&&(v.current=e))}),[v,w]);(0,a.useEffect)((function(){var e=N&&t&&(0,o.isLocalURL)(f),n="undefined"!==typeof m?m:r&&r.locale,c=l[f+"%"+p+(n?"%"+n:"")];e&&!c&&d(r,f,p,{locale:n})}),[p,f,N,m,t,r]);var P={ref:_,onClick:function(e){y.props&&"function"===typeof y.props.onClick&&y.props.onClick(e),e.defaultPrevented||function(e,t,r,n,c,a,i,s){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,o.isLocalURL)(r))&&(e.preventDefault(),null==i&&(i=n.indexOf("#")<0),t[c?"replace":"push"](r,n,{shallow:a,locale:s,scroll:i}))}(e,r,f,p,b,O,h,m)},onMouseEnter:function(e){(0,o.isLocalURL)(f)&&(y.props&&"function"===typeof y.props.onMouseEnter&&y.props.onMouseEnter(e),d(r,f,p,{priority:!0}))}};if(e.passHref||"a"===y.type&&!("href"in y.props)){var E="undefined"!==typeof m?m:r&&r.locale,I=r&&r.isLocaleDomain&&(0,o.getDomainLocale)(p,E,r&&r.locales,r&&r.domainLocales);P.href=I||(0,o.addBasePath)((0,o.addLocale)(p,E,r&&r.defaultLocale))}return a.default.cloneElement(y,P)};t.default=u},u6i0:function(e,t,r){"use strict";r.r(t);var n=r("nKUr"),c=r("g4pe"),a=r.n(c),o=r("q1tI"),i=r("qG/y"),s=r("20a2"),l=r("YFqc"),d=r.n(l),u=r("rePB"),f=r("EFaQ"),p=r("WtUO");function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){Object(u.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=function(e){var t=e.order,r=Object(o.useRef)(),c=Object(o.useContext)(i.a),a=c.state,s=c.dispatch,l=a.auth,d=a.orders;return Object(o.useEffect)((function(){paypal.Buttons({createOrder:function(e,r){return r.order.create({purchase_units:[{amount:{value:t.total}}]})},onApprove:function(e,r){return s({type:"NOTIFY",payload:{loading:!0}}),r.order.capture().then((function(e){Object(f.c)("order/payment/".concat(t._id),{paymentId:e.payer.payer_id},l.token).then((function(r){return r.err?s({type:"NOTIFY",payload:{error:r.err}}):(s(Object(p.f)(d,t._id,b(b({},t),{},{paid:!0,dateOfPayment:e.create_time,paymentId:e.payer.payer_id,method:"Paypal"}),"ADD_ORDERS")),s({type:"NOTIFY",payload:{success:r.msg}}))}))}))}}).render(r.current)}),[]),Object(n.jsx)("div",{ref:r})};function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){Object(u.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=function(e){var t=e.orderDetail,r=e.state,c=e.dispatch,a=r.auth,o=r.orders;return a.user?Object(n.jsx)(n.Fragment,{children:t.map((function(e){return Object(n.jsxs)("div",{style:{margin:"20px auto"},className:"row justify-content-around",children:[Object(n.jsxs)("div",{className:"text-uppercase my-3",style:{maxWidth:"600px"},children:[Object(n.jsxs)("h2",{className:"text-break",children:["Order ",e._id]}),Object(n.jsxs)("div",{className:"mt-4 text-secondary",children:[Object(n.jsx)("h3",{children:"Shipping"}),Object(n.jsxs)("p",{children:["Name: ",e.user.name]}),Object(n.jsxs)("p",{children:["Email: ",e.user.email]}),Object(n.jsxs)("p",{children:["Address: ",e.address]}),Object(n.jsxs)("p",{children:["Mobile: ",e.mobile]}),Object(n.jsxs)("div",{className:"alert ".concat(e.delivered?"alert-success":"alert-danger","\n                        d-flex justify-content-between align-items-center"),role:"alert",children:[e.delivered?"Deliverd on ".concat(e.updatedAt):"Not Delivered","admin"===a.user.role&&!e.delivered&&Object(n.jsx)("button",{className:"btn btn-dark text-uppercase",onClick:function(){return function(e){c({type:"NOTIFY",payload:{loading:!0}}),Object(f.c)("order/delivered/".concat(e._id),null,a.token).then((function(t){if(t.err)return c({type:"NOTIFY",payload:{error:t.err}});var r=t.result,n=r.paid,a=r.dateOfPayment,i=r.method,s=r.delivered;return c(Object(p.f)(o,e._id,m(m({},e),{},{paid:n,dateOfPayment:a,method:i,delivered:s}),"ADD_ORDERS")),c({type:"NOTIFY",payload:{success:t.msg}})}))}(e)},children:"Mark as delivered"})]}),Object(n.jsx)("h3",{children:"Payment"}),e.method&&Object(n.jsxs)("h6",{children:["Method: ",Object(n.jsx)("em",{children:e.method})]}),e.paymentId&&Object(n.jsxs)("p",{children:["PaymentId: ",Object(n.jsx)("em",{children:e.paymentId})]}),Object(n.jsx)("div",{className:"alert ".concat(e.paid?"alert-success":"alert-danger","\n                        d-flex justify-content-between align-items-center"),role:"alert",children:e.paid?"Paid on ".concat(e.dateOfPayment):"Not Paid"}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h3",{children:"Order Items"}),e.cart.map((function(e){return Object(n.jsxs)("div",{className:"row border-bottom mx-0 p-2 justify-content-betwenn align-items-center",style:{maxWidth:"550px"},children:[Object(n.jsx)("img",{src:e.images[0].url,alt:e.images[0].url,style:{width:"50px",height:"45px",objectFit:"cover"}}),Object(n.jsx)("h5",{className:"flex-fill text-secondary px-3 m-0",children:Object(n.jsx)(d.a,{href:"/product/".concat(e._id),children:Object(n.jsx)("a",{children:e.title})})}),Object(n.jsxs)("span",{className:"text-info m-0",children:[e.quantity," x $",e.price," = $",e.price*e.quantity]})]},e._id)}))]})]})]}),!e.paid&&"admin"!==a.user.role&&Object(n.jsxs)("div",{className:"p-4",children:[Object(n.jsxs)("h2",{className:"mb-4 text-uppercase",children:["Total: $",e.total]}),Object(n.jsx)(O,{order:e})]})]},e._id)}))}):null};t.default=function(){var e=Object(o.useContext)(i.a),t=e.state,r=e.dispatch,c=t.orders,l=t.auth,d=Object(s.useRouter)(),u=Object(o.useState)([]),f=u[0],p=u[1];return Object(o.useEffect)((function(){var e=c.filter((function(e){return e._id===d.query.id}));p(e)}),[c]),l.user?Object(n.jsxs)("div",{className:"my-3",children:[Object(n.jsx)(a.a,{children:Object(n.jsx)("title",{children:"Detail Orders"})}),Object(n.jsx)("div",{children:Object(n.jsxs)("button",{className:"btn btn-dark",onClick:function(){return d.back()},children:[Object(n.jsx)("i",{className:"fas fa-long-arrow-alt-left","aria-hidden":"true"})," Go Back"]})}),Object(n.jsx)(y,{orderDetail:f,state:t,dispatch:r})]}):null}},vNVm:function(e,t,r){"use strict";var n=r("J4zp");t.__esModule=!0,t.useIntersection=function(e){var t=e.rootMargin,r=e.disabled||!o,s=(0,c.useRef)(),l=(0,c.useState)(!1),d=n(l,2),u=d[0],f=d[1],p=(0,c.useCallback)((function(e){s.current&&(s.current(),s.current=void 0),r||u||e&&e.tagName&&(s.current=function(e,t,r){var n=function(e){var t=e.rootMargin||"",r=i.get(t);if(r)return r;var n=new Map,c=new IntersectionObserver((function(e){e.forEach((function(e){var t=n.get(e.target),r=e.isIntersecting||e.intersectionRatio>0;t&&r&&t(r)}))}),e);return i.set(t,r={id:t,observer:c,elements:n}),r}(r),c=n.id,a=n.observer,o=n.elements;return o.set(e,t),a.observe(e),function(){o.delete(e),a.unobserve(e),0===o.size&&(a.disconnect(),i.delete(c))}}(e,(function(e){return e&&f(e)}),{rootMargin:t}))}),[r,t,u]);return(0,c.useEffect)((function(){if(!o&&!u){var e=(0,a.requestIdleCallback)((function(){return f(!0)}));return function(){return(0,a.cancelIdleCallback)(e)}}}),[u]),[p,u]};var c=r("q1tI"),a=r("0G5g"),o="undefined"!==typeof IntersectionObserver;var i=new Map}},[["Ivv9",0,2,1,3,4]]]);