_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[10],{"0+Tl":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("o0o1"),a=r.n(n),c=r("HaE+");function o(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw c}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s=function(){var e=Object(c.a)(a.a.mark((function e(t){var r,n,c,i,s,l,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=o(t),e.prev=2,n.s();case 4:if((c=n.n()).done){e.next=19;break}return i=c.value,(s=new FormData).append("file",i),s.append("upload_preset","nextjs_store"),s.append("cloud_name","bafir24"),e.next=12,fetch("https://api.cloudinary.com/v1_1/bafir24/image/upload",{method:"POST",body:s});case 12:return l=e.sent,e.next=15,l.json();case 15:u=e.sent,r.push({public_id:u.public_id,url:u.secure_url});case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),n.e(e.t0);case 24:return e.prev=24,n.f(),e.finish(24);case 27:return e.abrupt("return",r);case 28:case"end":return e.stop()}}),e,null,[[2,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()},"20a2":function(e,t,r){e.exports=r("nOHt")},KNPb:function(e,t,r){"use strict";r.r(t);var n=r("nKUr"),a=r("o0o1"),c=r.n(a),o=r("HaE+"),i=r("KQm4"),s=r("rePB"),l=r("g4pe"),u=r.n(l),p=r("q1tI"),d=r("qG/y"),b=r("0+Tl"),j=r("EFaQ"),m=r("20a2");function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.default=function(){var e={title:"",price:0,inStock:0,description:"",content:"",category:""},t=Object(p.useState)(e),r=t[0],a=t[1],l=r.title,f=r.price,h=r.inStock,y=r.description,x=r.content,g=r.category,v=Object(p.useState)([]),N=v[0],w=v[1],k=Object(p.useContext)(d.a),_=k.state,P=k.dispatch,S=_.categories,T=_.auth,F=Object(m.useRouter)().query.id,I=Object(p.useState)(!1),E=I[0],C=I[1];Object(p.useEffect)((function(){F?(C(!0),Object(j.b)("product/".concat(F)).then((function(e){a(e.product),w(e.product.images)}))):(C(!1),a(e),w([]))}),[F]);var Y=function(e){var t=e.target,n=t.name,c=t.value;a(O(O({},r),{},Object(s.a)({},n,c))),P({type:"NOTIFY",payload:{}})},A=function(){var e=Object(o.a)(c.a.mark((function e(t){var n,a,o,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),"admin"===T.user.role){e.next=3;break}return e.abrupt("return",P({type:"NOTIFY",payload:{error:"Authentication is not valid."}}));case 3:if(l&&f&&h&&y&&x&&"all"!==g&&0!==N.length){e.next=5;break}return e.abrupt("return",P({type:"NOTIFY",payload:{error:"Please add all the fields."}}));case 5:if(P({type:"NOTIFY",payload:{loading:!0}}),n=[],a=N.filter((function(e){return!e.url})),o=N.filter((function(e){return e.url})),!(a.length>0)){e.next=13;break}return e.next=12,Object(b.a)(a);case 12:n=e.sent;case 13:if(!E){e.next=21;break}return e.next=16,Object(j.e)("product/".concat(F),O(O({},r),{},{images:[].concat(Object(i.a)(o),Object(i.a)(n))}),T.token);case 16:if(!(s=e.sent).err){e.next=19;break}return e.abrupt("return",P({type:"NOTIFY",payload:{error:s.err}}));case 19:e.next=26;break;case 21:return e.next=23,Object(j.d)("product",O(O({},r),{},{images:[].concat(Object(i.a)(o),Object(i.a)(n))}),T.token);case 23:if(!(s=e.sent).err){e.next=26;break}return e.abrupt("return",P({type:"NOTIFY",payload:{error:s.err}}));case 26:return e.abrupt("return",P({type:"NOTIFY",payload:{success:s.msg}}));case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"products_manager",children:[Object(n.jsx)(u.a,{children:Object(n.jsx)("title",{children:"Products Manager"})}),Object(n.jsxs)("form",{className:"row",onSubmit:A,children:[Object(n.jsxs)("div",{className:"col-md-6",children:[Object(n.jsx)("input",{type:"text",name:"title",value:l,placeholder:"Title",className:"d-block my-4 w-100 p-2",onChange:Y}),Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"col-sm-6",children:[Object(n.jsx)("label",{htmlFor:"price",children:"Price"}),Object(n.jsx)("input",{type:"number",name:"price",value:f,placeholder:"Price",className:"d-block w-100 p-2",onChange:Y})]}),Object(n.jsxs)("div",{className:"col-sm-6",children:[Object(n.jsx)("label",{htmlFor:"price",children:"In Stock"}),Object(n.jsx)("input",{type:"number",name:"inStock",value:h,placeholder:"inStock",className:"d-block w-100 p-2",onChange:Y})]})]}),Object(n.jsx)("textarea",{name:"description",id:"description",cols:"30",rows:"4",placeholder:"Description",onChange:Y,className:"d-block my-4 w-100 p-2",value:y}),Object(n.jsx)("textarea",{name:"content",id:"content",cols:"30",rows:"6",placeholder:"Content",onChange:Y,className:"d-block my-4 w-100 p-2",value:x}),Object(n.jsx)("div",{className:"input-group-prepend px-0 my-2",children:Object(n.jsxs)("select",{name:"category",id:"category",value:g,onChange:Y,className:"custom-select text-capitalize",children:[Object(n.jsx)("option",{value:"all",children:"All Products"}),S.map((function(e){return Object(n.jsx)("option",{value:e._id,children:e.name},e._id)}))]})}),Object(n.jsx)("button",{type:"submit",className:"btn btn-info my-2 px-4",children:E?"Update":"Create"})]}),Object(n.jsxs)("div",{className:"col-md-6 my-4",children:[Object(n.jsxs)("div",{className:"input-group mb-3",children:[Object(n.jsx)("div",{className:"input-group-prepend",children:Object(n.jsx)("span",{className:"input-group-text",children:"Upload"})}),Object(n.jsx)("div",{className:"custom-file border rounded",children:Object(n.jsx)("input",{type:"file",className:"custom-file-input",onChange:function(e){P({type:"NOTIFY",payload:{}});var t=[],r=0,n="",a=Object(i.a)(e.target.files);return 0===a.length?P({type:"NOTIFY",payload:{error:"Files does not exist."}}):(a.forEach((function(e){return e.size>1048576?n="The largest image size is 1mb":"image/jpeg"!==e.type&&"image/png"!==e.type?n="Image format is incorrect.":((r+=1)<=5&&t.push(e),t)})),n&&P({type:"NOTIFY",payload:{error:n}}),N.length+t.length>5?P({type:"NOTIFY",payload:{error:"Select up to 5 images."}}):void w([].concat(Object(i.a)(N),t)))},multiple:!0,accept:"image/*"})})]}),Object(n.jsx)("div",{className:"row img-up mx-0",children:N.map((function(e,t){return Object(n.jsxs)("div",{className:"file_img my-1",children:[Object(n.jsx)("img",{src:e.url?e.url:URL.createObjectURL(e),alt:"",className:"img-thumbnail rounded"}),Object(n.jsx)("span",{onClick:function(){return function(e){var t=Object(i.a)(N);t.splice(e,1),w(t)}(t)},children:"X"})]},t)}))})]})]})]})}},ZFar:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create/[[...id]]",function(){return r("KNPb")}])}},[["ZFar",0,2,1,3,4]]]);