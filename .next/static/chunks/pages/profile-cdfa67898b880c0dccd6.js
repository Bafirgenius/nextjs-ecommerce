_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[15],{"0+Tl":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r("o0o1"),n=r.n(a),s=r("HaE+");function c(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,s=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw s}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var i=function(){var e=Object(s.a)(n.a.mark((function e(t){var r,a,s,o,i,l,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=c(t),e.prev=2,a.s();case 4:if((s=a.n()).done){e.next=19;break}return o=s.value,(i=new FormData).append("file",o),i.append("upload_preset","nextjs_store"),i.append("cloud_name","bafir24"),e.next=12,fetch("https://api.cloudinary.com/v1_1/bafir24/image/upload",{method:"POST",body:i});case 12:return l=e.sent,e.next=15,l.json();case 15:u=e.sent,r.push({public_id:u.public_id,url:u.secure_url});case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),a.e(e.t0);case 24:return e.prev=24,a.f(),e.finish(24);case 27:return e.abrupt("return",r);case 28:case"end":return e.stop()}}),e,null,[[2,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()},"W+IF":function(e,t,r){"use strict";r.r(t);var a=r("nKUr"),n=r("o0o1"),s=r.n(n),c=r("HaE+"),o=r("rePB"),i=r("g4pe"),l=r.n(i),u=r("q1tI"),d=r("qG/y"),f=r("YFqc"),p=r.n(f),b=r("cSol"),j=r("EFaQ"),m=r("0+Tl");function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.default=function(){var e=Object(u.useState)({avatar:"",name:"",password:"",cf_password:""}),t=e[0],r=e[1],n=t.avatar,i=t.name,f=t.password,h=t.cf_password,O=Object(u.useContext)(d.a),y=O.state,x=O.dispatch,g=y.auth,w=y.notify,N=y.orders;Object(u.useEffect)((function(){g.user&&r(v(v({},t),{},{name:g.user.name}))}),[g.user]);var _=function(e){var a=e.target,n=a.name,s=a.value;r(v(v({},t),{},Object(o.a)({},n,s))),x({type:"NOTIFY",payload:{}})},I=function(){x({type:"NOTIFY",payload:{loading:!0}}),Object(j.c)("user/resetPassword",{password:f},g.token).then((function(e){return e.err?x({type:"NOTIFY",payload:{error:e.err}}):x({type:"NOTIFY",payload:{success:e.msg}})}))},k=function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x({type:"NOTIFY",payload:{loading:!0}}),!n){e.next=5;break}return e.next=4,Object(m.a)([n]);case 4:t=e.sent;case 5:Object(j.c)("user",{name:i,avatar:n?t[0].url:g.user.avatar},g.token).then((function(e){return e.err?x({type:"NOTIFY",payload:{error:e.err}}):(x({type:"AUTH",payload:{token:g.token,user:e.user}}),x({type:"NOTIFY",payload:{success:e.msg}}))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return g.user?Object(a.jsxs)("div",{className:"profile_page",children:[Object(a.jsx)(l.a,{children:Object(a.jsx)("title",{children:"Profile"})}),Object(a.jsxs)("section",{className:"row text-secondary my-3",children:[Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("h3",{className:"text-center text-uppercase",children:"user"===g.user.role?"User Profile":"Admin Profile"}),Object(a.jsxs)("div",{className:"avatar",children:[Object(a.jsx)("img",{src:n?URL.createObjectURL(n):g.user.avatar,alt:"avatar"}),Object(a.jsxs)("span",{children:[Object(a.jsx)("i",{className:"fas fa-camera"}),Object(a.jsx)("p",{children:"Change"}),Object(a.jsx)("input",{type:"file",name:"file",id:"file_up",accept:"image/*",onChange:function(e){var a=e.target.files[0];return a?a.size>1048576?x({type:"NOTIFY",payload:{error:"The largest image size is 1mb."}}):"image/jpeg"!==a.type&&"image/png"!==a.type?x({type:"NOTIFY",payload:{error:"Image format is incorrect."}}):void r(v(v({},t),{},{avatar:a})):x({type:"NOTIFY",payload:{error:"File does not exist."}})}})]})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"name",children:"Name"}),Object(a.jsx)("input",{type:"text",name:"name",value:i,className:"form-control",placeholder:"Your name",onChange:_})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"email",children:"Email"}),Object(a.jsx)("input",{type:"text",name:"email",defaultValue:g.user.email,className:"form-control",disabled:!0})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"password",children:"New Password"}),Object(a.jsx)("input",{type:"password",name:"password",value:f,className:"form-control",placeholder:"Your new password",onChange:_})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"cf_password",children:"Confirm New Password"}),Object(a.jsx)("input",{type:"password",name:"cf_password",value:h,className:"form-control",placeholder:"Confirm new password",onChange:_})]}),Object(a.jsx)("button",{className:"btn btn-info",disabled:w.loading,onClick:function(e){if(e.preventDefault(),f){var t=Object(b.a)(i,g.user.email,f,h);if(t)return x({type:"NOTIFY",payload:{error:t}});I()}(i!==g.user.name||n)&&k()},children:"Update"})]}),Object(a.jsxs)("div",{className:"col-md-8",children:[Object(a.jsx)("h3",{className:"text-uppercase",children:"Orders"}),Object(a.jsx)("div",{className:"my-3 table-responsive",children:Object(a.jsxs)("table",{className:"table-bordered table-hover w-100 text-uppercase",style:{minWidth:"600px",cursor:"pointer"},children:[Object(a.jsx)("thead",{className:"bg-light font-weight-bold",children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{className:"p-2",children:"id"}),Object(a.jsx)("td",{className:"p-2",children:"date"}),Object(a.jsx)("td",{className:"p-2",children:"total"}),Object(a.jsx)("td",{className:"p-2",children:"delivered"}),Object(a.jsx)("td",{className:"p-2",children:"paid"})]})}),Object(a.jsx)("tbody",{children:N.map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{className:"p-2",children:Object(a.jsx)(p.a,{href:"/order/".concat(e._id),children:Object(a.jsx)("a",{children:e._id})})}),Object(a.jsx)("td",{className:"p-2",children:new Date(e.createdAt).toLocaleDateString()}),Object(a.jsxs)("td",{className:"p-2",children:["$",e.total]}),Object(a.jsx)("td",{className:"p-2",children:e.delivered?Object(a.jsx)("i",{className:"fas fa-check text-success"}):Object(a.jsx)("i",{className:"fas fa-times text-danger"})}),Object(a.jsx)("td",{className:"p-2",children:e.paid?Object(a.jsx)("i",{className:"fas fa-check text-success"}):Object(a.jsx)("i",{className:"fas fa-times text-danger"})})]},e._id)}))})]})})]})]})]}):null}},YFqc:function(e,t,r){e.exports=r("cTJO")},cSol:function(e,t,r){"use strict";t.a=function(e,t,r,a){return e&&t&&r?function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}(t)?r.length<6?"Password must be at least 6 characters.":r!==a?"Confirm password did not match.":void 0:"Invalid emails.":"Please add all fields."}},cTJO:function(e,t,r){"use strict";var a=r("J4zp"),n=r("284h");t.__esModule=!0,t.default=void 0;var s=n(r("q1tI")),c=r("elyg"),o=r("nOHt"),i=r("vNVm"),l={};function u(e,t,r,a){if(e&&(0,c.isLocalURL)(t)){e.prefetch(t,r,a).catch((function(e){0}));var n=a&&"undefined"!==typeof a.locale?a.locale:e&&e.locale;l[t+"%"+r+(n?"%"+n:"")]=!0}}var d=function(e){var t=!1!==e.prefetch,r=(0,o.useRouter)(),n=r&&r.pathname||"/",d=s.default.useMemo((function(){var t=(0,c.resolveHref)(n,e.href,!0),r=a(t,2),s=r[0],o=r[1];return{href:s,as:e.as?(0,c.resolveHref)(n,e.as):o||s}}),[n,e.href,e.as]),f=d.href,p=d.as,b=e.children,j=e.replace,m=e.shallow,h=e.scroll,v=e.locale;"string"===typeof b&&(b=s.default.createElement("a",null,b));var O=s.Children.only(b),y=O&&"object"===typeof O&&O.ref,x=(0,i.useIntersection)({rootMargin:"200px"}),g=a(x,2),w=g[0],N=g[1],_=s.default.useCallback((function(e){w(e),y&&("function"===typeof y?y(e):"object"===typeof y&&(y.current=e))}),[y,w]);(0,s.useEffect)((function(){var e=N&&t&&(0,c.isLocalURL)(f),a="undefined"!==typeof v?v:r&&r.locale,n=l[f+"%"+p+(a?"%"+a:"")];e&&!n&&u(r,f,p,{locale:a})}),[p,f,N,v,t,r]);var I={ref:_,onClick:function(e){O.props&&"function"===typeof O.props.onClick&&O.props.onClick(e),e.defaultPrevented||function(e,t,r,a,n,s,o,i){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,c.isLocalURL)(r))&&(e.preventDefault(),null==o&&(o=a.indexOf("#")<0),t[n?"replace":"push"](r,a,{shallow:s,locale:i,scroll:o}))}(e,r,f,p,j,m,h,v)},onMouseEnter:function(e){(0,c.isLocalURL)(f)&&(O.props&&"function"===typeof O.props.onMouseEnter&&O.props.onMouseEnter(e),u(r,f,p,{priority:!0}))}};if(e.passHref||"a"===O.type&&!("href"in O.props)){var k="undefined"!==typeof v?v:r&&r.locale,E=r&&r.isLocaleDomain&&(0,c.getDomainLocale)(p,k,r&&r.locales,r&&r.domainLocales);I.href=E||(0,c.addBasePath)((0,c.addLocale)(p,k,r&&r.defaultLocale))}return s.default.cloneElement(O,I)};t.default=d},u1GD:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return r("W+IF")}])},vNVm:function(e,t,r){"use strict";var a=r("J4zp");t.__esModule=!0,t.useIntersection=function(e){var t=e.rootMargin,r=e.disabled||!c,i=(0,n.useRef)(),l=(0,n.useState)(!1),u=a(l,2),d=u[0],f=u[1],p=(0,n.useCallback)((function(e){i.current&&(i.current(),i.current=void 0),r||d||e&&e.tagName&&(i.current=function(e,t,r){var a=function(e){var t=e.rootMargin||"",r=o.get(t);if(r)return r;var a=new Map,n=new IntersectionObserver((function(e){e.forEach((function(e){var t=a.get(e.target),r=e.isIntersecting||e.intersectionRatio>0;t&&r&&t(r)}))}),e);return o.set(t,r={id:t,observer:n,elements:a}),r}(r),n=a.id,s=a.observer,c=a.elements;return c.set(e,t),s.observe(e),function(){c.delete(e),s.unobserve(e),0===c.size&&(s.disconnect(),o.delete(n))}}(e,(function(e){return e&&f(e)}),{rootMargin:t}))}),[r,t,d]);return(0,n.useEffect)((function(){if(!c&&!d){var e=(0,s.requestIdleCallback)((function(){return f(!0)}));return function(){return(0,s.cancelIdleCallback)(e)}}}),[d]),[p,d]};var n=r("q1tI"),s=r("0G5g"),c="undefined"!==typeof IntersectionObserver;var o=new Map}},[["u1GD",0,2,1,3,4]]]);